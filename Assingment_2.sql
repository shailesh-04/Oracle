--  Create following tables and perform following operations
  --ACMASTER 
  CREATE TABLE ACMASTER(
    ACNO INT,
    NAME VARCHAR(10),
    ADATE DATE,
    BAL DECIMAL(9,3),
    CONSTRAINTS PRIMARY_ACNO PRIMARY KEY(ACNO) 
  ); 
  --ACTRAN 
  CREATE TABLE ACTRAN (
    TNO INT(3),
    TDATE DATE,
    AMOUNT DECIMAL(7,2),
    TYPE CHAR(1),
    ACNO INT(3),
    CONSTRAINTS FK_ACNO FOREIGN KEY (ACNO) REFERENCES ACMASTER(ACNO)
);

-- Insert 10 records in ACMASTER table
INSERT INTO ACMASTER (ACNO, NAME, ADATE, BAL) VALUES(101, 'ASHOK', '1997-04-01', 5000.00);
INSERT INTO ACMASTER (ACNO, NAME, ADATE, BAL) VALUES(102, 'NILESH', '1998-06-02', 1000.00);
INSERT INTO ACMASTER (ACNO, NAME, ADATE, BAL) VALUES(103, 'RITESH', '1998-07-04', 2060.00);
INSERT INTO ACMASTER (ACNO, NAME, ADATE, BAL) VALUES(104, 'MUKESH', '1998-12-20', 5000.00);
INSERT INTO ACMASTER (ACNO, NAME, ADATE, BAL) VALUES(105, 'JAYESH', '1998-12-25', 60000.00);
INSERT INTO ACMASTER (ACNO, NAME, ADATE, BAL) VALUES(106, 'RAJESH', '1999-01-26', 2400.00);
INSERT INTO ACMASTER (ACNO, NAME, ADATE, BAL) VALUES(107, 'KUNAL', '1999-01-21', 1500.00);
INSERT INTO ACMASTER (ACNO, NAME, ADATE, BAL) VALUES(108, 'DEVANG', '1999-01-20', 1999.00);
INSERT INTO ACMASTER (ACNO, NAME, ADATE, BAL) VALUES(109, 'ABHAY', '1999-02-26', 2050.00);
INSERT INTO ACMASTER (ACNO, NAME, ADATE, BAL) VALUES(110, 'KAPIL', '1999-03-25', 1000.00);
-- Insert 10 records in ACTRAN table
INSERT INTO ACTRAN (TNO, TDATE, AMOUNT, TYPE, ACNO) VALUES(1, '2000-04-01', 500.00, 'W', 101);
INSERT INTO ACTRAN (TNO, TDATE, AMOUNT, TYPE, ACNO) VALUES(2, '2000-06-02', 1000.00, 'D', 101);
INSERT INTO ACTRAN (TNO, TDATE, AMOUNT, TYPE, ACNO) VALUES(3, '2000-07-04', 500.00, 'W', 102);
INSERT INTO ACTRAN (TNO, TDATE, AMOUNT, TYPE, ACNO) VALUES(4, '2000-12-20', 6000.00, 'D', 103);
INSERT INTO ACTRAN (TNO, TDATE, AMOUNT, TYPE, ACNO) VALUES(5, '2001-12-25', 200.00, 'D', 105);
INSERT INTO ACTRAN (TNO, TDATE, AMOUNT, TYPE, ACNO) VALUES(6, '2001-01-26', 1500.00, 'D', 106);
INSERT INTO ACTRAN (TNO, TDATE, AMOUNT, TYPE, ACNO) VALUES(7, '2001-01-21', 3000.00, 'D', 105);
INSERT INTO ACTRAN (TNO, TDATE, AMOUNT, TYPE, ACNO) VALUES(8, '2002-01-20', 5000.00, 'D', 102);
INSERT INTO ACTRAN (TNO, TDATE, AMOUNT, TYPE, ACNO) VALUES(9, '2002-02-26', 50000.00, 'D', 101);
INSERT INTO ACTRAN (TNO, TDATE, AMOUNT, TYPE, ACNO) VALUES(10, '2003-03-25', 4500.00, 'D', 109);

--===============================================--
-- 1. Modify balance of all rows of ACMASTER by adding 100 rupees in their current balance.
UPDATE ACMASTER 
  SET BAL = BAL + 100;
-- 2. Delete the row from ACTRAN table having transaction no 1.
DELETE FROM ACTRAN 
  WHERE TNO= 101;
-- 3. Replace the name MUKESH with ROGER having account number 104
UPDATE ACMASTER 
  SET NAME = 'MUKESH' 
  WHERE ACNO = 104;
-- 4. Delete account having account no 110
DELETE FROM ACMASTER 
  WHERE ACNO = 110;
-- 5. Display all account holders’ name those who have opened account before year 1999
SELECT NAME FROM ACMASTER 
  WHERE ADATE < '1999-01-01';
-- 6. List all transactions of account number 101
SELECT * FROM A
  WHERE ACNO = 101;
-- 7. List all account holders detail having balance greater than 2000
SELECT * FROM ACMASTER
  WHERE BAL > 2000;
-- 8. Update transaction type and amount with D and 5000 having transition no 3
UPDATE ACTRAN 
  SET AMOUNT=5000,TYPE = 'D'
  WHERE TNO = 3;
-- 9. Display all rows of ACTRAN
SELECT * FROM ACTRAN;
-- 10. Add column CITY in ACMASTER
ALTER TABLE ACMASTER 
  ADD CITY VARCHAR(20);
--11. Add city name in following order
  -- a. 101 MAHUVA
  UPDATE ACMASTER 
    SET CITY = 'MAHUVA';
    WHERE ACNO = 101;
  -- b. 102 BHAVNAGAR
  UPDATE ACMASTER 
    SET CITY = 'BHAVNAGAR';
    WHERE ACNO = 102;
  -- c. 103 RAJKOT
  UPDATE ACMASTER 
    SET CITY = 'RAJKOT';
    WHERE ACNO = 103;
  -- d. 104 JUNAGADH
  UPDATE ACMASTER 
    SET CITY = 'JUNAGADH';
    WHERE ACNO = 104;
  -- e. 105 to 109 KATPAR
  UPDATE ACMASTER 
    SET CITY = 'KATPAR';
    WHERE ACNO >= 105 AND ACNO <= 109;
  
-- 12. Change date to ‘1-APR-2002’ of transaction no 9
UPDATE ACMASTER 
    SET TDATE = '1-APR-2002';
    WHERE TNO = 109;